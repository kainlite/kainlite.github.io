<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Gabriel" />
    <meta name="description" content="Articles about Kubernetes, CI/CD, Git, Linux, Containers, Golang, and probably some more random stuff, you can subscribe via RSS or JSON Feed.">
    <link rel="shortcut icon" type="image/x-icon" href="https://techsquad.rocks/img/favicon.ico">
    <title>How to create a serverless twitter bot</title>
    <meta name="generator" content="Hugo 0.57.2" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://techsquad.rocks/css/main.css" /><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/tomorrow.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css">
    <link rel="stylesheet" type="text/css" href="https://techsquad.rocks/css/gruvbox-dark.min.css" />
    
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,200bold,400old" />
    
    <!--[if lt IE 9]>
                        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
                        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->


    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-8919037-7', 'auto');
	
	ga('send', 'pageview');
}
</script>
<meta property="description" content="Introduction This article explains how to create a serverless tweet-bot, basically pulls articles from this blog and post them to twitter in a nice way. It uses cron as the trigger so it should post a tweet every 12 hours, or you can invoke it manually.
Twitter So before you can start with the Twitter API you need to get a developer account in this url, after submitted and created, you then need to create an App and generate the keys and tokens to be able to use it, it might take a while, I recommend you read everything that Twitter wants you to read while creating both the dev account and the app, so you can understand the scope and the good practices of using their services." />

    <meta property="og:title" content="How to create a serverless twitter bot" />
<meta property="og:description" content="Introduction This article explains how to create a serverless tweet-bot, basically pulls articles from this blog and post them to twitter in a nice way. It uses cron as the trigger so it should post a tweet every 12 hours, or you can invoke it manually.
Twitter So before you can start with the Twitter API you need to get a developer account in this url, after submitted and created, you then need to create an App and generate the keys and tokens to be able to use it, it might take a while, I recommend you read everything that Twitter wants you to read while creating both the dev account and the app, so you can understand the scope and the good practices of using their services." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://techsquad.rocks/blog/creating_a_serverless_twitter_bot/" />
<meta property="og:image" content="https://techsquad.rocks/img/logo.png?1567813057" />


<meta property="article:tag" content="go" />
<meta property="article:tag" content="aws" />
<meta property="article:tag" content="serverless" />

<meta property="og:locale" content="en" />


    <meta name="twitter:title" content="How to create a serverless twitter bot"/>
<meta name="twitter:description" content="Introduction This article explains how to create a serverless tweet-bot, basically pulls articles from this blog and post them to twitter in a nice way. It uses cron as the trigger so it should post a tweet every 12 hours, or you can invoke it manually.
Twitter So before you can start with the Twitter API you need to get a developer account in this url, after submitted and created, you then need to create an App and generate the keys and tokens to be able to use it, it might take a while, I recommend you read everything that Twitter wants you to read while creating both the dev account and the app, so you can understand the scope and the good practices of using their services.?1567813057"/>
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image:src" content="https://techsquad.rocks/img/logo.png?1567813057" />


<link rel="publisher" href="https://techsquad.rocks">
<link rel="author" href="https://twitter.com/kainlite">
<meta property="author" content="Tech Squad">
<meta property="og:type" content="article">
<meta name="twitter:card" content="summary_large_image">
<meta property="article:publisher" content="https://techsquad.rocks">
<meta property="article:author" content="https://twitter.com/kainlite">
<meta name="twitter:site" content="@kainlite">
<meta property="og:site_name" content="Tech Squad">

  </head>

  <body>
    <div id="wrap">

      
      <nav class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <a class="navbar-brand" href="https://techsquad.rocks/"><i class="fa fa-home"></i></a>
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div class="navbar-collapse collapse" id="navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
        <li><a href="/blog/">BLOG</a></li>
        
      
      </ul>
    </div>
  </div>
</nav>

      

      <div class="modal fade" id="enlargeImageModal" tabindex="-1" role="dialog" aria-labelledby="enlargeImageModal" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button>
            </div>
            <div class="modal-body">
              <img src="" class="enlargeImageModalSource" style="width: 100%;">
            </div>
          </div>
        </div>
      </div>

      <div class="container">
        <div class="blog-post">
          <h3>
            <strong><a href="https://techsquad.rocks/blog/creating_a_serverless_twitter_bot/">How to create a serverless twitter bot</a></strong>
          </h3>
        </div>
        <div class="blog-title">
          <h4>
          January 22, 2019
            &nbsp;&nbsp;
            
            
              <a href="https://techsquad.rocks/tags/go/" class="label label-success">
                    go
                  </a>&nbsp; <a href="https://techsquad.rocks/tags/aws/" class="label label-success">
                    aws
                  </a>&nbsp; <a href="https://techsquad.rocks/tags/serverless/" class="label label-success">
                    serverless
                  </a>
          </h4>
        </div>
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="blogpost">
              

<h3 id="introduction"><strong>Introduction</strong></h3>

<p>This article explains how to create a serverless tweet-bot, basically pulls articles from this blog and post them to twitter in a nice way. It uses cron as the trigger so it should post a tweet every 12 hours, or you can invoke it manually.</p>

<h3 id="twitter"><strong>Twitter</strong></h3>

<p>So before you can start with the Twitter API you need to get a developer account in <a href="https://developer.twitter.com/en/apply/user">this url</a>, after submitted and created, you then need to create an App and generate the keys and tokens to be able to use it, it might take a while, I recommend you read everything that Twitter wants you to read while creating both the dev account and the app, so you can understand the scope and the good practices of using their services.</p>

<h3 id="the-code"><strong>The code</strong></h3>

<p>I added several comments over the code so it&rsquo;s easy to understand what everything is supposed to do, also it can be found <a href="https://github.com/kainlite/tbo">here</a>.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;encoding/json&#34;</span>
	<span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;io/ioutil&#34;</span>
	<span style="color:#e6db74">&#34;math/rand&#34;</span>
	<span style="color:#e6db74">&#34;net/http&#34;</span>
	<span style="color:#e6db74">&#34;os&#34;</span>
	<span style="color:#e6db74">&#34;strings&#34;</span>
	<span style="color:#e6db74">&#34;time&#34;</span>

	<span style="color:#e6db74">&#34;github.com/aws/aws-lambda-go/lambda&#34;</span>
	<span style="color:#e6db74">&#34;github.com/dghubble/go-twitter/twitter&#34;</span>
	<span style="color:#e6db74">&#34;github.com/dghubble/oauth1&#34;</span>
	<span style="color:#e6db74">&#34;github.com/joho/godotenv&#34;</span>
	<span style="color:#a6e22e">log</span> <span style="color:#e6db74">&#34;github.com/sirupsen/logrus&#34;</span>
)

<span style="color:#75715e">// Version
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">Version</span> <span style="color:#66d9ef">string</span>

<span style="color:#75715e">// Environment
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">Env</span> <span style="color:#66d9ef">string</span>

<span style="color:#75715e">// Page JSON object
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Page</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Version</span>  <span style="color:#66d9ef">string</span>    <span style="color:#e6db74">`json:&#34;version&#34;`</span>
	<span style="color:#a6e22e">Title</span>    <span style="color:#66d9ef">string</span>    <span style="color:#e6db74">`json:&#34;title&#34;`</span>
	<span style="color:#a6e22e">BaseURL</span>  <span style="color:#66d9ef">string</span>    <span style="color:#e6db74">`json:&#34;home_page_url&#34;`</span>
	<span style="color:#a6e22e">FeedURL</span>  <span style="color:#66d9ef">string</span>    <span style="color:#e6db74">`json:&#34;feed_url&#34;`</span>
	<span style="color:#a6e22e">Articles</span> []<span style="color:#a6e22e">Article</span> <span style="color:#e6db74">`json:&#34;items&#34;`</span>
}

<span style="color:#75715e">// Article JSON object
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Article</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">ID</span>        <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;id&#34;`</span>
	<span style="color:#a6e22e">URL</span>       <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;url&#34;`</span>
	<span style="color:#a6e22e">Title</span>     <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;title&#34;`</span>
	<span style="color:#a6e22e">Content</span>   <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;content_html&#34;`</span>
	<span style="color:#a6e22e">Published</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;date_published&#34;`</span>
}

<span style="color:#75715e">// Twitter Access
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Twitter</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">config</span>      <span style="color:#f92672">*</span><span style="color:#a6e22e">oauth1</span>.<span style="color:#a6e22e">Config</span>
	<span style="color:#a6e22e">token</span>       <span style="color:#f92672">*</span><span style="color:#a6e22e">oauth1</span>.<span style="color:#a6e22e">Token</span>
	<span style="color:#a6e22e">httpClient</span>  <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Client</span>
	<span style="color:#a6e22e">client</span>      <span style="color:#f92672">*</span><span style="color:#a6e22e">twitter</span>.<span style="color:#a6e22e">Client</span>
	<span style="color:#a6e22e">tweetFormat</span> <span style="color:#66d9ef">string</span>
	<span style="color:#a6e22e">screenName</span>  <span style="color:#66d9ef">string</span>
}

<span style="color:#75715e">// This functions grabs all the necessary bits to connect to the Twitter API.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Twitter</span>) <span style="color:#a6e22e">Setup</span>() {
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Debug</span>(<span style="color:#e6db74">&#34;Setting up twitter client&#34;</span>)
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">twitterAccessKey</span> <span style="color:#66d9ef">string</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">twitterAccessSecret</span> <span style="color:#66d9ef">string</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">twitterConsumerKey</span> <span style="color:#66d9ef">string</span>
	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">twitterConsumerSecret</span> <span style="color:#66d9ef">string</span>

	<span style="color:#75715e">// Get the access keys from ENV
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">twitterAccessKey</span> = <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Getenv</span>(<span style="color:#e6db74">&#34;TWITTER_ACCESS_KEY&#34;</span>)
	<span style="color:#a6e22e">twitterAccessSecret</span> = <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Getenv</span>(<span style="color:#e6db74">&#34;TWITTER_ACCESS_SECRET&#34;</span>)
	<span style="color:#a6e22e">twitterConsumerKey</span> = <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Getenv</span>(<span style="color:#e6db74">&#34;TWITTER_CONSUMER_KEY&#34;</span>)
	<span style="color:#a6e22e">twitterConsumerSecret</span> = <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Getenv</span>(<span style="color:#e6db74">&#34;TWITTER_CONSUMER_SECRET&#34;</span>)
	<span style="color:#a6e22e">twitterScreenName</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Getenv</span>(<span style="color:#e6db74">&#34;TWITTER_SCREEN_NAME&#34;</span>)

	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">twitterScreenName</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Twitter screen name cannot be null&#34;</span>)
	}

	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">twitterConsumerKey</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#e6db74">&#34;Twitter consumer key can not be null&#34;</span>)
	}

	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">twitterConsumerSecret</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#e6db74">&#34;Twitter consumer secret can not be null&#34;</span>)
	}

	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">twitterAccessKey</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#e6db74">&#34;Twitter access key can not be null&#34;</span>)
	}

	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">twitterAccessSecret</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#e6db74">&#34;Twitter access secret can not be null&#34;</span>)
	}

	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Debug</span>(<span style="color:#e6db74">&#34;Setting up oAuth for twitter&#34;</span>)
	<span style="color:#75715e">// Setup the new oauth client
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">config</span> = <span style="color:#a6e22e">oauth1</span>.<span style="color:#a6e22e">NewConfig</span>(<span style="color:#a6e22e">twitterConsumerKey</span>, <span style="color:#a6e22e">twitterConsumerSecret</span>)
	<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">token</span> = <span style="color:#a6e22e">oauth1</span>.<span style="color:#a6e22e">NewToken</span>(<span style="color:#a6e22e">twitterAccessKey</span>, <span style="color:#a6e22e">twitterAccessSecret</span>)
	<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">httpClient</span> = <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">Client</span>(<span style="color:#a6e22e">oauth1</span>.<span style="color:#a6e22e">NoContext</span>, <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">token</span>)

	<span style="color:#75715e">// Twitter client
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">client</span> = <span style="color:#a6e22e">twitter</span>.<span style="color:#a6e22e">NewClient</span>(<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">httpClient</span>)

	<span style="color:#75715e">// Set the screen name for later use
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">screenName</span> = <span style="color:#a6e22e">twitterScreenName</span>

	<span style="color:#75715e">// This is the format of the tweet
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">tweetFormat</span> = <span style="color:#e6db74">&#34;%s: %s - TBO&#34;</span>
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Debug</span>(<span style="color:#e6db74">&#34;Twitter client setup complete&#34;</span>)
}

<span style="color:#75715e">// Format tweets
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Twitter</span>) <span style="color:#a6e22e">GetTweetString</span>(<span style="color:#a6e22e">article</span> <span style="color:#a6e22e">Article</span>) <span style="color:#66d9ef">string</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">tweetFormat</span>, <span style="color:#a6e22e">article</span>.<span style="color:#a6e22e">Title</span>, <span style="color:#a6e22e">article</span>.<span style="color:#a6e22e">URL</span>)
}

<span style="color:#75715e">// Send the tweet
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Twitter</span>) <span style="color:#a6e22e">Send</span>(<span style="color:#a6e22e">article</span> <span style="color:#a6e22e">Article</span>) {
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Debug</span>(<span style="color:#e6db74">&#34;Sending tweet&#34;</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">Env</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;production&#34;</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Infof</span>(<span style="color:#e6db74">&#34;Non production mode, would&#39;ve tweeted: %s&#34;</span>, <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">GetTweetString</span>(<span style="color:#a6e22e">article</span>))
	}
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">Env</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;production&#34;</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Infof</span>(<span style="color:#e6db74">&#34;Sending tweet: %s&#34;</span>, <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">GetTweetString</span>(<span style="color:#a6e22e">article</span>))
		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">Statuses</span>.<span style="color:#a6e22e">Update</span>(<span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">GetTweetString</span>(<span style="color:#a6e22e">article</span>), <span style="color:#66d9ef">nil</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
			<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Error sending tweet to twitter: %s&#34;</span>, <span style="color:#a6e22e">err</span>)
		}
	}
}

<span style="color:#75715e">// Get a random article from the feed
</span><span style="color:#75715e">// This functions checks that the same tweet is not present
</span><span style="color:#75715e">// in the last 30 tweets
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Twitter</span>) <span style="color:#a6e22e">PickArticle</span>(<span style="color:#a6e22e">article</span> <span style="color:#a6e22e">Article</span>) <span style="color:#66d9ef">bool</span> {
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Debug</span>(<span style="color:#e6db74">&#34;Checking to see if the tweet appeared in the last 30 tweets&#34;</span>)

	<span style="color:#a6e22e">tweets</span>, <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">Timelines</span>.<span style="color:#a6e22e">UserTimeline</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">twitter</span>.<span style="color:#a6e22e">UserTimelineParams</span>{
		<span style="color:#a6e22e">ScreenName</span>: <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">screenName</span>,
		<span style="color:#a6e22e">Count</span>:      <span style="color:#ae81ff">30</span>,
		<span style="color:#a6e22e">TweetMode</span>:  <span style="color:#e6db74">&#34;extended&#34;</span>,
	})

	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Error getting last 30 tweets from user: %s&#34;</span>, <span style="color:#a6e22e">err</span>)
	}

	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">tweet</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">tweets</span> {
		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">Contains</span>(<span style="color:#a6e22e">tweet</span>.<span style="color:#a6e22e">Text</span>, <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">GetTweetString</span>(<span style="color:#a6e22e">article</span>)) {
			<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>
		}
	}

	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>
}

<span style="color:#75715e">// Twitter API constant
</span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">tw</span> <span style="color:#a6e22e">Twitter</span>

<span style="color:#75715e">// This function is rather large, but basically grabs the a big json from
</span><span style="color:#75715e">// the jsonfeed url and tests several tweets until it finds one that it&#39;s valid
</span><span style="color:#75715e">// a tweet could be invalid if for example it was already tweeted in the last 30 tweets
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">GetArticle</span>() <span style="color:#a6e22e">Article</span> {
	<span style="color:#a6e22e">url</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;https://techsquad.rocks/index.json&#34;</span>

	<span style="color:#75715e">// Setup a new HTTP Client with 3 seconds timeout
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">httpClient</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Client</span>{
		<span style="color:#a6e22e">Timeout</span>: <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span>,
	}

	<span style="color:#75715e">// Create a new HTTP Request
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">NewRequest</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">MethodGet</span>, <span style="color:#a6e22e">url</span>, <span style="color:#66d9ef">nil</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#75715e">// An error has occurred that we can&#39;t recover from, bail.
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Error occurred creating new request: %s&#34;</span>, <span style="color:#a6e22e">err</span>)
	}

	<span style="color:#75715e">// Set the user agent to tbo &lt;version&gt; - twitter.com/kainlite
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">Header</span>.<span style="color:#a6e22e">Set</span>(<span style="color:#e6db74">&#34;User-Agent&#34;</span>, <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;TBO %s - twitter.com/kainlite&#34;</span>, <span style="color:#a6e22e">Version</span>))

	<span style="color:#75715e">// Tell the remote server to send us JSON
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">Header</span>.<span style="color:#a6e22e">Set</span>(<span style="color:#e6db74">&#34;Accept&#34;</span>, <span style="color:#e6db74">&#34;application/json&#34;</span>)

	<span style="color:#75715e">// We&#39;re only going to try maxTries times, otherwise we&#39;ll fatal out.
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// Execute the request
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Debugf</span>(<span style="color:#e6db74">&#34;Attempting request to %s&#34;</span>, <span style="color:#a6e22e">req</span>)
	<span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">getErr</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">httpClient</span>.<span style="color:#a6e22e">Do</span>(<span style="color:#a6e22e">req</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">getErr</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#75715e">// We got an error, lets bail out, we can&#39;t do anything more
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Error occurred retrieving article from API: %s&#34;</span>, <span style="color:#a6e22e">getErr</span>)
	}

	<span style="color:#75715e">// BGet the body from the result
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">body</span>, <span style="color:#a6e22e">readErr</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ioutil</span>.<span style="color:#a6e22e">ReadAll</span>(<span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">Body</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">readErr</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#75715e">// This shouldn&#39;t happen, but if it does, error out.
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Error occurred reading from result body: %s&#34;</span>, <span style="color:#a6e22e">readErr</span>)
	}

	<span style="color:#75715e">// Parse json into the struct Page
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">page</span> <span style="color:#a6e22e">Page</span>
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Unmarshal</span>(<span style="color:#a6e22e">body</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">page</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#75715e">// Invalid JSON was received, bail out
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Error occurred decoding article: %s&#34;</span>, <span style="color:#a6e22e">err</span>)
	}

	<span style="color:#a6e22e">invalidArticle</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">true</span>
	<span style="color:#a6e22e">try</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>
	<span style="color:#a6e22e">maxTries</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">10</span>

	<span style="color:#75715e">// Attempt to get a valid article for the next tweet
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">article</span> <span style="color:#a6e22e">Article</span>
	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">invalidArticle</span> {
		<span style="color:#a6e22e">rand</span>.<span style="color:#a6e22e">Seed</span>(<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>().<span style="color:#a6e22e">UnixNano</span>())
		<span style="color:#a6e22e">randomInt</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">rand</span>.<span style="color:#a6e22e">Intn</span>(len(<span style="color:#a6e22e">page</span>.<span style="color:#a6e22e">Articles</span>))
		<span style="color:#a6e22e">article</span> = <span style="color:#a6e22e">page</span>.<span style="color:#a6e22e">Articles</span>[<span style="color:#a6e22e">randomInt</span>]

		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;%+v&#34;</span>, <span style="color:#a6e22e">randomInt</span>)
		<span style="color:#75715e">// check to make sure the tweet hasn&#39;t been sent before
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">tw</span>.<span style="color:#a6e22e">PickArticle</span>(<span style="color:#a6e22e">article</span>) {
			<span style="color:#a6e22e">try</span> <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
			<span style="color:#66d9ef">continue</span>
		}

		<span style="color:#75715e">// If we get here we&#39;ve found a tweet, exit the loop
</span><span style="color:#75715e"></span>		<span style="color:#a6e22e">invalidArticle</span> = <span style="color:#66d9ef">false</span>

		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">try</span> <span style="color:#f92672">&gt;=</span> <span style="color:#a6e22e">maxTries</span> {
			<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#e6db74">&#34;Exiting after attempts to retrieve article failed.&#34;</span>)

		}
	}

	<span style="color:#75715e">// Return the valid article response
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">article</span>
}

<span style="color:#75715e">// HandleRequest - Handle the incoming Lambda request
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">HandleRequest</span>() {
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Debug</span>(<span style="color:#e6db74">&#34;Started handling request&#34;</span>)
	<span style="color:#a6e22e">tw</span>.<span style="color:#a6e22e">Setup</span>()
	<span style="color:#a6e22e">article</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">GetArticle</span>()

	<span style="color:#75715e">// Send tweet
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">tw</span>.<span style="color:#a6e22e">Send</span>(<span style="color:#a6e22e">article</span>)
}

<span style="color:#75715e">// Set the local environment
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">setRunningEnvironment</span>() {
	<span style="color:#75715e">// Get the environment variable
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">switch</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Getenv</span>(<span style="color:#e6db74">&#34;APP_ENV&#34;</span>) {
	<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;production&#34;</span>:
		<span style="color:#a6e22e">Env</span> = <span style="color:#e6db74">&#34;production&#34;</span>
	<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;development&#34;</span>:
		<span style="color:#a6e22e">Env</span> = <span style="color:#e6db74">&#34;development&#34;</span>
	<span style="color:#66d9ef">default</span>:
		<span style="color:#a6e22e">Env</span> = <span style="color:#e6db74">&#34;development&#34;</span>
	}

	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">Env</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;production&#34;</span> {
		<span style="color:#a6e22e">Version</span> = <span style="color:#a6e22e">Env</span>
	}
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">shutdown</span>() {
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Info</span>(<span style="color:#e6db74">&#34;Shutdown request registered&#34;</span>)
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">init</span>() {
	<span style="color:#75715e">// Set the environment
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">setRunningEnvironment</span>()

	<span style="color:#75715e">// Set logging configuration
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">SetFormatter</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">TextFormatter</span>{
		<span style="color:#a6e22e">DisableColors</span>: <span style="color:#66d9ef">true</span>,
		<span style="color:#a6e22e">FullTimestamp</span>: <span style="color:#66d9ef">true</span>,
	})

	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">SetReportCaller</span>(<span style="color:#66d9ef">true</span>)
	<span style="color:#66d9ef">switch</span> <span style="color:#a6e22e">Env</span> {
	<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;development&#34;</span>:
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">SetLevel</span>(<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">DebugLevel</span>)
	<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;production&#34;</span>:
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">SetLevel</span>(<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">ErrorLevel</span>)
	<span style="color:#66d9ef">default</span>:
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">SetLevel</span>(<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">InfoLevel</span>)
	}
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#75715e">// Start the bot
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Debug</span>(<span style="color:#e6db74">&#34;Starting main&#34;</span>)
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;TBO %s&#34;</span>, <span style="color:#a6e22e">Version</span>)

	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">Env</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;production&#34;</span> {
		<span style="color:#a6e22e">lambda</span>.<span style="color:#a6e22e">Start</span>(<span style="color:#a6e22e">HandleRequest</span>)
	} <span style="color:#66d9ef">else</span> {
		<span style="color:#75715e">// this environment variables are used locally while debugging, it can be quite handy
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">godotenv</span>.<span style="color:#a6e22e">Load</span>(); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
			<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#e6db74">&#34;Error loading .env file&#34;</span>)
		}
		<span style="color:#a6e22e">HandleRequest</span>()
	}
}</code></pre></div>
The code is fairly straigth forward, it checks for the environment to have a locally runable/debuggable app if it&rsquo;s development or if it&rsquo;s running as an AWS Function in production.</p>

<h3 id="while-debugging-locally-it-can-be-ran-like-this"><strong>While debugging locally it can be ran like this</strong></h3>

<p>You can save use an .env file to test debug how your tweets are going to look.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">go run .
<span style="color:#75715e"># OUTPUT:</span>
<span style="color:#75715e"># time=&#34;2019-01-21T22:39:15-03:00&#34; level=debug msg=&#34;Starting main&#34; func=main.main file=&#34;/home/kainlite/Webs/tbo/tbo/main.go:279&#34;</span>
<span style="color:#75715e"># time=&#34;2019-01-21T22:39:15-03:00&#34; level=info msg=&#34;TBO development&#34; func=main.main file=&#34;/home/kainlite/Webs/tbo/tbo/main.go:280&#34;</span>
<span style="color:#75715e"># time=&#34;2019-01-21T22:39:15-03:00&#34; level=debug msg=&#34;Started handling request&#34; func=main.HandleRequest file=&#34;/home/kainlite/Webs/tbo/tbo/main.go:225&#34;</span>
<span style="color:#75715e"># time=&#34;2019-01-21T22:39:15-03:00&#34; level=debug msg=&#34;Setting up twitter client&#34; func=&#34;main.(*Twitter).Setup&#34; file=&#34;/home/kainlite/Webs/tbo/tbo/main.go:55&#34;</span>
<span style="color:#75715e"># time=&#34;2019-01-21T22:39:15-03:00&#34; level=debug msg=&#34;Setting up oAuth for twitter&#34; func=&#34;main.(*Twitter).Setup&#34; file=&#34;/home/kainlite/Webs/tbo/tbo/main.go:88&#34;</span>
<span style="color:#75715e"># time=&#34;2019-01-21T22:39:15-03:00&#34; level=debug msg=&#34;Twitter client setup complete&#34; func=&#34;main.(*Twitter).Setup&#34; file=&#34;/home/kainlite/Webs/tbo/tbo/main.go:102&#34;</span>
<span style="color:#75715e"># time=&#34;2019-01-21T22:39:15-03:00&#34; level=debug msg=&#34;Attempting request to &amp;{GET https://techsquad.rocks/index.json HTTP/1.1 %!s(int=1) %!s(int=1) map[User-Agent:[TBO development - twitter.com/kainlite] Accept:[application/json]] &lt;nil&gt; %!s(func() (io.ReadCloser, error)=&lt;nil&gt;) %!s(int64=0) [] %!s(bool=false) techsquad.rocks map[] map[] %!s(*multipart.Form=&lt;nil&gt;) map[]   %!s(*tls.ConnectionState=&lt;nil&gt;) %!s(&lt;-chan struct {}=&lt;nil&gt;) %!s(*http.Response=&lt;nil&gt;) &lt;nil&gt;}&#34; func=main.GetArticle file=&#34;/home/kainlite/Webs/tbo/tbo/main.go:173&#34;</span>
<span style="color:#75715e"># 4time=&#34;2019-01-21T22:39:15-03:00&#34; level=debug msg=&#34;Checking to see if the tweet appeared in the last 30 tweets&#34; func=&#34;main.(*Twitter).PickArticle&#34; file=&#34;/home/kainlite/Webs/tbo/tbo/main.go:125&#34;</span>
<span style="color:#75715e"># time=&#34;2019-01-21T22:39:16-03:00&#34; level=debug msg=&#34;Sending tweet&#34; func=&#34;main.(*Twitter).Send&#34; file=&#34;/home/kainlite/Webs/tbo/tbo/main.go:111&#34;</span>
<span style="color:#75715e"># time=&#34;2019-01-21T22:39:16-03:00&#34; level=info msg=&#34;Non production mode, would&#39;ve tweeted: Getting started with skaffold: https://techsquad.rocks/blog/getting_started_with_skaffold/ - TBO&#34; func=&#34;main.(*Twitter).Send&#34; file=&#34;/home/kainlite/Webs/tbo/tbo/main.go:113&#34;</span></code></pre></div>
The output is very verbose but it will show you everything that the function will do.</p>

<h3 id="creating-the-project"><strong>Creating the project</strong></h3>

<p>But how did you get the project skeleton?
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir tbo <span style="color:#f92672">&amp;&amp;</span> cd tbo <span style="color:#f92672">&amp;&amp;</span> serverless create -t aws-go</code></pre></div>
By default it creates two go functions: hello and world, if you look at the files serverless.yaml and the go code, it will be easy to understand how everything is tied together in the default example.</p>

<h3 id="serverless-framework"><strong>Serverless framework</strong></h3>

<p>This function is managed by the <a href="https://serverless.com/">serverless framework</a>, as you can see it&rsquo;s an easy way to manage your functions, what this small block of YAML will do is compile, upload, and schedule our function (because we use an event schedule)
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Welcome to Serverless!</span>
#
<span style="color:#75715e"># This file is the main config file for your service.</span>
<span style="color:#75715e"># It&#39;s very minimal at this point and uses default values.</span>
<span style="color:#75715e"># You can always add more config options for more control.</span>
<span style="color:#75715e"># We&#39;ve included some commented out config examples here.</span>
<span style="color:#75715e"># Just uncomment any of them to get that config option.</span>
#
<span style="color:#75715e"># For full config options, check the docs:</span>
<span style="color:#75715e">#    docs.serverless.com</span>
#
<span style="color:#75715e"># Happy Coding!</span>

service: handler

<span style="color:#75715e"># You can pin your service to only deploy with a specific Serverless version</span>
<span style="color:#75715e"># Check out our docs for more details</span>
<span style="color:#75715e"># frameworkVersion: &#34;=X.X.X&#34;</span>
frameworkVersion: <span style="color:#e6db74">&#34;&gt;=1.28.0 &lt;2.0.0&#34;</span>

provider:
  name: aws
  runtime: go1.x
  region: <span style="color:#e6db74">${</span>env:AWS_DEFAULT_REGION, <span style="color:#e6db74">&#39;us-east-1&#39;</span><span style="color:#e6db74">}</span>
  stage: <span style="color:#e6db74">${</span>env:TBO_BUILD_STAGE, <span style="color:#e6db74">&#39;prod&#39;</span><span style="color:#e6db74">}</span>
  memorySize: <span style="color:#ae81ff">128</span>
  versionFunctions: false

package:
 exclude:
   - ./**
 include:
   - ./tbo/tbo

functions:
  tweet:
    handler: tbo/tbo
    events:
      - schedule: cron<span style="color:#f92672">(</span><span style="color:#ae81ff">0</span> */12 * * ? *<span style="color:#f92672">)</span>
    environment:
      APP_ENV: <span style="color:#e6db74">&#34;production&#34;</span>
      TWITTER_SCREEN_NAME: <span style="color:#e6db74">&#34;twitter_username&#34;</span>
      TWITTER_CONSUMER_KEY: <span style="color:#e6db74">&#34;example_key&#34;</span>
      TWITTER_CONSUMER_SECRET: <span style="color:#e6db74">&#34;example_secret&#34;</span>
      TWITTER_ACCESS_KEY: <span style="color:#e6db74">&#34;example_key&#34;</span>
      TWITTER_ACCESS_SECRET: <span style="color:#e6db74">&#34;example_secret&#34;</span></code></pre></div>
We provide the environment variables there that the app needs to run, under the hood what serverless will do is create an s3 bucket for this function with a cloudformation stack and a zip file with your function (for each version or deployment), then it will apply that that stack and validate that everything went ok.</p>

<h3 id="deploy-the-function"><strong>Deploy the function</strong></h3>

<p>Once the code is ready and you are ready to test it in production aka send a real tweet, just deploy it.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">serverless deploy
<span style="color:#75715e"># OUTPUT:</span>
<span style="color:#75715e"># Serverless: WARNING: Missing &#34;tenant&#34; and &#34;app&#34; properties in serverless.yml. Without these properties, you can not publish the service to the Serverless Platform.</span>
<span style="color:#75715e"># Serverless: Packaging service...</span>
<span style="color:#75715e"># Serverless: Excluding development dependencies...</span>
<span style="color:#75715e"># Serverless: Uploading CloudFormation file to S3...</span>
<span style="color:#75715e"># Serverless: Uploading artifacts...</span>
<span style="color:#75715e"># Serverless: Uploading service .zip file to S3 (9.86 MB)...</span>
<span style="color:#75715e"># Serverless: Validating template...</span>
<span style="color:#75715e"># Serverless: Updating Stack...</span>
<span style="color:#75715e"># Serverless: Checking Stack update progress...</span>
<span style="color:#75715e"># ..................</span>
<span style="color:#75715e"># Serverless: Stack update finished...</span>
<span style="color:#75715e"># Service Information</span>
<span style="color:#75715e"># service: handler</span>
<span style="color:#75715e"># stage: prod</span>
<span style="color:#75715e"># region: us-east-1</span>
<span style="color:#75715e"># stack: handler-prod</span>
<span style="color:#75715e"># api keys:</span>
<span style="color:#75715e">#   None</span>
<span style="color:#75715e"># endpoints:</span>
<span style="color:#75715e">#   None</span>
<span style="color:#75715e"># functions:</span>
<span style="color:#75715e">#   tweet: handler-prod-tweet</span>
<span style="color:#75715e"># layers:</span>
<span style="color:#75715e">#   None</span></code></pre></div>
As we described before you can see everything that the serverless framework did for us, nothing really hard to remember and everything automated.</p>

<h3 id="s3"><strong>S3</strong></h3>

<p>Example s3 bucket from the previous deployment.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">aws s3 ls
<span style="color:#75715e"># OUTPUT:</span>
<span style="color:#75715e"># 2019-01-21 22:42:05 handler-prod-serverlessdeploymentbucket-1s5fs5igk2pwc</span></code></pre></div>
As we can see after the deployment we see a new bucket with our function and if we take a look at the files we will find several (depending on how many deployments you do) stacks/manifests and the zip file with our function for each version/deployment.</p>

<h3 id="invoke-the-function"><strong>Invoke the function</strong></h3>

<p>Ok, but I don&rsquo;t want to wait 12 hours to see if everything is okay, then just invoke the function.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">serverless invoke -f tweet
<span style="color:#75715e"># OUTPUT:</span>
<span style="color:#75715e"># null</span></code></pre></div>
Wait, where did tweet came from?, if you look at the serverless manifest you will see that our function is called tweet. If everything went well you will be able to see that tweet in your profile, something like this:
<figure class="zoom">
    <img src="/img/twitter-tbo.png" width="100%"/> 
</figure>
</p>

<h3 id="notes">Notes</h3>

<ul>
<li>Why TBO, what&rsquo;s tbo? bot misspelled.</li>
<li>The Serverless framework is really cool and works in a variety of environments, I certainly recommend taking a look and at least trying it, I use it for a few small projects and it eases my life a lot.</li>
</ul>

<h3 id="errata">Errata</h3>

<p>If you spot any error or have any suggestion, please send me a message so it gets fixed.</p>

<p>Also, you can check the source code and changes in the <a href="https://github.com/kainlite/kainlite.github.io">generated code</a> and the <a href="https://github.com/kainlite/blog">sources here</a></p>

              <hr>
              
              <div class="related-posts">
                <h5>Related Posts</h5>
                
                  <div class="row">
                    <div class="col-sm-4 col-md-4 col-lg-4">
                      <h6 style="text-align: right">
                        September 2, 2019
                      </h6>
                    </div>
                    <div class="col-sm-8 col-md-8 col-lg-8">
                      <h6 style="text-align: left">
                        <strong><a href="/blog/serverless_authentication_with_cognito_and_golang/">Serverless authentication with Cognito and Go</a></strong>
                      </h6>
                    </div>
                  </div>
                
                  <div class="row">
                    <div class="col-sm-4 col-md-4 col-lg-4">
                      <h6 style="text-align: right">
                        June 23, 2019
                      </h6>
                    </div>
                    <div class="col-sm-8 col-md-8 col-lg-8">
                      <h6 style="text-align: left">
                        <strong><a href="/blog/go_grpc_cheap_ping/">Go gRPC Cheap Ping</a></strong>
                      </h6>
                    </div>
                  </div>
                
                  <div class="row">
                    <div class="col-sm-4 col-md-4 col-lg-4">
                      <h6 style="text-align: right">
                        May 5, 2019
                      </h6>
                    </div>
                    <div class="col-sm-8 col-md-8 col-lg-8">
                      <h6 style="text-align: left">
                        <strong><a href="/blog/go_continuous_delivery_with_terraform_and_kubernetes/">Go continuous delivery with Terraform and Kubernetes</a></strong>
                      </h6>
                    </div>
                  </div>
                
              </div>
            </div>
          </div>
          
          <hr>
        <div class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">

    (function() {
      
      
      if (window.location.hostname == "localhost")
        return;

      var disqus_shortname = 'kainlite';
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

        </div>
      </div>
      
    </div>

    
    <footer>
  <div id="footer">
    <div class="container">
      <p class="text-muted">&copy; All rights reserved. Powered by <a href="https://gohugo.io/">Hugo</a> and
      <a href="http://www.github.com/nurlansu/hugo-sustain/">sustain</a> with â™¥</p>
    </div>
  </div>
</footer>
<div class="footer"></div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://techsquad.rocks/js/docs.min.js"></script>
<script src="https://techsquad.rocks/js/main.js"></script>

<script src="https://techsquad.rocks/js/ie10-viewport-bug-workaround.js"></script><!-- Syntax highlighting -->
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>




  </body>
</html>
